= Spring Data JPA to Quarkus Hibernate ORM with Panache
:experimental:

*Spring Data JPA* enables Java developers to implement JPA-based repositories but also quickly to build applications with data access technology. Implementing the data access layer of an application has been a hassle for quite some time. To perform simple queries, pagination and auditing, you need to write boilerplate code. Spring Data JPA aims to improve the implementation of the data access layer by creating repository interfaces and custom finder methods. 

For example, let's take a look at the `OwnerRepository` class in `src/main/java/org/springframework/samples/petclinic/owner` of Spring Petclinic application. This   repository class showcases how to execute JPA queries and and save an object to the data store:

[source,java]
----
public interface OwnerRepository extends Repository<Owner, Integer> {

	/**
	 * Retrieve {@link Owner}s from the data store by last name, returning all owners
	 * whose last name <i>starts</i> with the given name.
	 * @param lastName Value to search for
	 * @return a Collection of matching {@link Owner}s (or an empty Collection if none
	 * found)
	 */
	@Query("SELECT DISTINCT owner FROM Owner owner left join fetch owner.pets WHERE owner.lastName LIKE :lastName%")
	@Transactional(readOnly = true)
	Collection<Owner> findByLastName(@Param("lastName") String lastName);

	/**
	 * Retrieve an {@link Owner} from the data store by id.
	 * @param id the id to search for
	 * @return the {@link Owner} if found
	 */
	@Query("SELECT owner FROM Owner owner left join fetch owner.pets WHERE owner.id =:id")
	@Transactional(readOnly = true)
	Owner findById(@Param("id") Integer id);

	/**
	 * Save an {@link Owner} to the data store, either inserting or updating it.
	 * @param owner the {@link Owner} to save
	 */
	void save(Owner owner);

}
----

Here are more use cases how the presentation layer maps to the persistence layer using Spring Data JPA in Spring Petclinic application:

 * Vets displays all vets and their specialties
 * FindOwners is used to find owners by last name
 * FindOwnersRedirect redirects to findOwner
 * SelectOwner allows user to select from a list of multiple owners with the same last name
 * Owner displays a owner's data and a list of the owner's pets and their data
 * OwnerRedirect redirects to owner
 * Owner supports AddOwnerForm and EditOwnerForm
 * Pet supports AddPetForm and EditPetForm
 * Visit supports AddVisitForm

Spring Petclinic application also supports 3 types of database such as *H2*, *HSQL*, and *MYSQL* below. In the previous lab, we used the _H2 in-memory database_ to store business data(i.e. vets, pets, owners):

image::spring-db-structure.png[quarkus, 400]

In this lab, we'll learn how simply refactor *Spring Data JPA* to *Quarkus Hibernate ORM with Panache*. Because _Hibernate ORM_ is the de facto JPA implementation and offers you the full breadth of an Object Relational Mapper. It makes complex mappings possible, but it does not make simple and common mappings trivial. _Hibernate ORM with Panache_ focuses on making your entities trivial and fun to write in _Quarkus_.

== Setting up and configuring Hibernate ORM with Panache

We'll add Quarkus extensions to the Inventory application for using Panache (a simplified way to access data via Hibernate ORM), a database with Postgres (in production) and H2 (in-memory database for testing). We’ll also add the ability to add health probes (which we’ll use later on) using the MicroProfile Health extension. Run the following commands to add the extensions using CodeReady Terminal: